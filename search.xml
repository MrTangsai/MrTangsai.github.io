<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[HMM模型和他的python应用]]></title>
    <url>%2F2018%2F05%2F30%2FHMM%E6%A8%A1%E5%9E%8B%E5%92%8C%E4%BB%96%E7%9A%84python%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[用隐含马尔可夫模型和他的应用对于序列标注问题，目前主流的方法是条件随机场和长短期记忆网络，而一些简单的任务如分词、词性标注和命名实体识别，应用隐马尔可夫模型能够快速同时高效地进行学习。 模型简介HMM被认为是解决大多数NLP问题最为快速有效的问题。将语言模型与通信问题联系起来，通信的本质是编解码和传输的过程。一个典型的通信系统包括信息源、信道、接收者、信息、上下文和编码。通信中，如何根据接收端的观测信号o1,o2,o3,…来推测信号源发送的信息s1,s2,s3,…?当然是求条件概率了。 $$s_1,s_2,s_3,…=ArgMax_{s_1,s_2,s_3,…}{P(s_1,s_2,s_3,…|o_1,o_2,o_3,…)}$$根据贝叶斯公式，上述公式也等价于 $$\frac{P(o_1,o_2,o_3,…|s_1,s_2,s_3,…)\cdot{P(s_1,s_2,s_3,…)}}{P(o_1,o_2,o_3,…)}$$公式中，分母可以看做是常数，因此对于通信问题求状态信息概率的问题可以看作是求联合概率$P(o_1,o_2,o_3,…|s_1,s_2,s_3,…)\cdot{P(s_1,s_2,s_3,…)}$,HMM模型通过简化该模型来计算信号源的概率。 HMM模型基于马尔可夫假设和独立输出假设。 符合马尔可夫假设的随机过程称为马尔可夫过程，也称为马尔可夫链。即随机状态中各个状态的概率分布只和前一个状态有关，下图表示一个离散的马尔可夫过程。其中，模型参数为转移概率，从一个状态转移到下一个状态的概率。随机选择初始状态后，运行一段时间T后，根据马尔可夫链的转移概率可以生成一个状态序列：$s_1,s_2,s_3,…,s_T$。或者可以根据已存在的状态序列，通过计算某一状态的出现次数与转到零一状态的次数之比来估计转移概率。HMM模型是马尔可夫模型的扩展，每一时刻输出ot,且只与st相关，st是不可见的，只能通过观察ot来估计隐含状态st。基于马尔可夫假设和独立输出假设，之前的联合概率可写作$$P(s_1,s_2,s_3,…,o_1,o_2,o_3,…)=\prod_tP(s_t|s_{t-1})\cdot{P(o_t|s_t)}$$其中，$P(s_t|s_{t-1}$称为转移概率，$P(o_t|s_t)$称为生成概率。HMM模型参数为$&lt;S,O,A,B,\Pi&gt;$ S表示模型状态，N是状态数量，$S={S_1,S_2,…,S_N}$ O表示每个状态的观察值，M为所有可能观察值的数量，$O={O_1,O_2,…,O_M}$ $A={a_{ij}}\in{R^{N*N}}$表示状态转移概率矩阵 $B={b_j(k)}\in{R^{N*M}}$表示生成概率矩阵 $\Pi\in{R^N}$表示初始状态概率 由此，通过$\Pi$和A可以生成隐含状态序列，然后由每一时刻的生成概率B可以产生观察序列。设模型参数为$\lambda$,模型给定时，有 $$P(s|\lambda)=\pi_{i_1}a_{i_1i_2}a_{i_2i_3}…a_{i_{T-1}i_T}$$ $$P(o|s,\lambda)=b_{i_1o_1}b_{i_2o_2}…b_{i_To_T}$$ $$P(o,s|\lambda)=\pi_{i_1}b_{i_1o_1}a_{i_1i_2}b_{i_2o_2}…a_{i_{T-1}}b_{i_To_T}$$ 围绕HMM模型有三个基本问题，不同的任务有不同的算法求解。 给定模型计算输出序列概率暴力计算列举出所有可能的状态序列，计算每个序列的联合概率$P(o,s|\lambda)$,然后全部相加，得到观测序列的概率$\sum_i{P(o,s|\lambda)}$。这样的计算方式时间复杂度高。 前向算法引入前向变量$\alpha_t(i)$,表示在t时刻状态为i时，输出序列为$o_1,o_2,…,o_T$的概率。这样，$P(o)=\alpha_t(1)+\alpha_t(2)+…+\alpha_t(i)$.而t时刻的前向变量可以通过t-1时刻的前向变量计算得到，以此类推，初始化计算出第一次的前向变量时，通过迭代最终可以计算出观察序列的概率。 $$\alpha_t(i+1)=(\sum_{i=1}^{N}{\alpha_t(i)})b_j{(o_{t+1})},1\leq{t}\leq{T-1}$$ 后向算法跟前向算法差不多，引入了后向变量$\beta_t(i)$ 给定模型和特定观察序列求概率最大的状态序列维特比算法可以将此类问题看作是动态规划，用维特比算法求解。在状态序列中，每一时刻的状态都有N种取值，假设序列长度为T，则一共有$N^T$种可能的状态序列，长序列时很难使用暴力计算来求解最大概率的路径。维特比算法认为概率最大的路径P经过序列上的任意时刻，从起始点到该时刻的这段路径一定也是到当前时刻的概率最大的路径，因此维特比从第一个时刻开始，依次考察路径的概率，计算得到的概率最大的路径经过的状态即是这一时刻的状态的取值。因此，每一步计算的复杂度都和相邻两个时刻$S_i$和$S_i+1$各自的节点数目$n_i$,$n_i+1$的乘积成正比，即$O(n_i\cdot{n_{i+1}})$. 估计模型参数已知观察序列和对应的状态序列观察序列和状态序列都已知的情况下，很好解决。利用样本中出现的各个取值的次数可以计算出大致的模型参数。 $$P(o_t|s_t)\approx\frac{(o_t,s_t)}{(s_t)}$$ $$P(s_t|s_{t-1})\approx\frac{(s_t,s_{t-1})}{(s_{t-1})}$$ 已知观察序列在已知观察序列未知状态序列的情况下，可以使用鲍姆韦尔奇算法求解，通过期望最大化（EM）算法进行迭代。首先找到一组能够产生输出序列O的模型参数，根据模型参数计算当前概率最大的状态序列的可能值并作为标注数据，按照3.1的方式重新计算模型参数，再次寻找概率最大的状态序列，一直迭代，直至模型性能收敛。]]></content>
      <categories>
        <category>NLP</category>
      </categories>
      <tags>
        <tag>HMM</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[给25岁的自己]]></title>
    <url>%2F2018%2F05%2F29%2F%E7%BB%9925%E5%B2%81%E7%9A%84%E8%87%AA%E5%B7%B1%2F</url>
    <content type="text"><![CDATA[给25岁的自己现在是2018年5月29日凌晨1点，写下这篇文章，给25岁即将毕业的我。希望自己以后每年都会有时间在这里写上一段话，以供后来的我瞻仰，额。。。好像不该用瞻仰这个词。 接下来的话全是即兴发挥，恩，可以说是接近乱扯了。 不迷茫研究生三年，边学边迷茫，想着要毕业了，应该不迷茫了吧。恩，不迷茫是不可能的。到现在，还是不清楚自己该做些什么。不过，这很重要吗？我一般都不怎么考虑这些大问题，日子慢慢过呗。 本科的时候很清楚自己要读研，因为总想着妈的学了这么多好耍的东西，上班了就用不了了就很亏啊。而且还年轻啊。年轻的时候何必让自己想那么多大人该想的事情，就做自己想做的。所以，继续读了三年书。实话讲，很庆幸这三年的时光，让自己有了很多思考的时间。以前从不会在凌晨的时候还在电脑前看书，写代码，现在，真的是，凌晨不学点东西，我浑身难受！我一直认为，研究生就是学会怎么和孤独相处的过程，每个人都有自己的事情，找到合拍的很难，自己的研究方向别人又很难搞懂，所以，自律就很重要了。哈哈，虽然我并不自律。但也努力地在每个阶段中去完成一些事情，回过头来看看，真的是收获颇丰啊。总结起来，学了很多领域的知识，硬件、软件、控制、图像、文本、数据挖掘，每个领域都很有趣，以后有咸鱼时间再利用这些知识做些好玩的事情吧。 学生时代的生活是在学习中寻找自己的人身价值，很遗憾，学生时代即将过去了，我也不知道我的人生价值是什么，十年之后，我会在哪里，做些什么，我都想象不出来。以前和朋友聊天的时候，我总结了一个观点，人分两种，一种是很清楚的知道每一个当下的自己该干嘛，对未来有个美好蓝图，然后朝着那个目标不断努力，另一种是不清楚自己以后该干嘛，在社会上大抵是被推着走的，就像是游戏里的角色，到了某一个关口，来不及反应，马上又有新的任务派给他了，完成之后又是新的任务。。。大多数人都是第二种吧，我也是，不过我觉得没什么差。何必需要一个蓝图来束缚自己，我的年龄、背景和阅历不足以让我在二十岁的时候意识到这个社会的法则，因此我也不需要当前我就有一个宏伟的目标，我需要的是一个一个的小目标，每完成一个，我就依照自己的兴趣给自己分配下一个。三十而立四十不惑嘛，慢慢地走到了那个阶段了，是什么就是什么，毕竟也有努力过，怎么可能会后悔呢？ 所以，只要自己想着要做什么，就做什么。哈哈哈，很佛性啊，不争不抢。 迷茫我目前的心性决定了我现在能想到的未来仅是半年后，再远就想不到了，也不需要去想，额，不知道以后会不会变，毕竟，这样的生活，对于在充满竞争的社会上，是出于劣势的。 之前也和朋友聊天说过这个问题，25岁了，没有考虑房子，没有考虑结婚，只想着觉得，恩，这个算法很牛批，我要来试试看，哟，那个框架很炫酷，现在就下载下来看看。这种态度在职场中是不讨好的，之前有过三个月的实习经历，深深觉得，要想升职加薪，真的要到处用心，把握每一个机会，而我，之前很看淡这些，觉得没得撒子意思的嘛，额，甚至呆的久了，觉得这种公司是真滴很没劲，人情世故要考虑，每次开会说什么要慎重。我知道这些在以后都是必备的技能，所以，很矛盾。慢慢来吧]]></content>
      <categories>
        <category>日记</category>
      </categories>
      <tags>
        <tag>日记</tag>
      </tags>
  </entry>
</search>
